"use strict";(self.webpackChunk_streamlit_app=self.webpackChunk_streamlit_app||[]).push([[9865],{19865:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var i=r(66845),n=r(17664),a=r(84256),o=r(3263),s=r(67930);const d=(0,r(74559).z)("div")({name:"DataGridOverlayEditorStyle",class:"gdg-d19meir1",propsAsIs:!1,vars:{"d19meir1-0":[e=>e.targetY,"px"],"d19meir1-1":[e=>e.targetX,"px"],"d19meir1-2":[e=>e.targetWidth,"px"],"d19meir1-3":[e=>e.targetHeight,"px"],"d19meir1-4":[e=>e.targetY+10,"px"],"d19meir1-5":[e=>Math.max(0,(e.targetHeight-28)/2),"px"]}});function l(){const[e,t]=function(){const[e,t]=i.useState();return[e??void 0,t]}(),[r,n]=i.useState(0),[a,o]=i.useState(!0);i.useLayoutEffect((()=>{if(void 0===e)return;if(!("IntersectionObserver"in window))return;const t=new IntersectionObserver((e=>{0!==e.length&&o(e[0].isIntersecting)}),{threshold:1});return t.observe(e),()=>t.disconnect()}),[e]),i.useEffect((()=>{if(a||void 0===e)return;let t;const r=()=>{const{right:i}=e.getBoundingClientRect();n((e=>Math.min(e+window.innerWidth-i-10,0))),t=requestAnimationFrame(r)};return t=requestAnimationFrame(r),()=>{void 0!==t&&cancelAnimationFrame(t)}}),[e,a]);return{ref:t,style:i.useMemo((()=>({transform:`translateX(${r}px)`})),[r])}}const c=e=>{const{target:t,content:r,onFinishEditing:c,forceEditMode:u,initialValue:g,imageEditorOverride:v,markdownDivCreateNode:m,highlight:p,className:f,theme:h,id:y,cell:b,bloom:E,validateCell:k,getCellRenderer:C,provideEditor:w,isOutsideClick:x}=e,[D,O]=i.useState(u?r:void 0),P=i.useRef(D??r);P.current=D??r;const[S,N]=i.useState((()=>void 0===k||!((0,s.T9)(r)&&!1===k?.(b,r,P.current)))),M=i.useCallback(((e,t)=>{c(S?e:void 0,t)}),[S,c]),R=i.useCallback((e=>{if(void 0!==k&&void 0!==e&&(0,s.T9)(e)){const t=k(b,e,P.current);!1===t?N(!1):"object"===typeof t?(e=t,N(!0)):N(!0)}O(e)}),[b,k]),F=i.useRef(!1),I=i.useRef(void 0),T=i.useCallback((()=>{M(D,[0,0]),F.current=!0}),[D,M]),A=i.useCallback(((e,t)=>{M(e,t??I.current??[0,0]),F.current=!0}),[M]),H=i.useCallback((async e=>{let t=!1;"Escape"===e.key?(e.stopPropagation(),e.preventDefault(),I.current=[0,0]):"Enter"!==e.key||e.shiftKey?"Tab"===e.key&&(e.stopPropagation(),e.preventDefault(),I.current=[e.shiftKey?-1:1,0],t=!0):(e.stopPropagation(),e.preventDefault(),I.current=[0,1],t=!0),window.setTimeout((()=>{F.current||void 0===I.current||(M(t?D:void 0,I.current),F.current=!0)}),0)}),[M,D]),_=D??r,[K,V]=i.useMemo((()=>{if((0,s.rs)(r))return[];const e=w?.(r);return void 0!==e?[e,!1]:[C(r)?.provideEditor?.(r),!1]}),[r,C,w]),{ref:W,style:X}=l();let Y,q,B=!0,G=!0;if(void 0!==K){B=!0!==K.disablePadding,G=!0!==K.disableStyling;const e=(0,s.DP)(K);e&&(q=K.styleOverride);const r=e?K.editor:K;Y=i.createElement(r,{isHighlighted:p,onChange:R,value:_,initialValue:g,onFinishedEditing:A,validatedSelection:(0,s.T9)(_)?_.selectionRange:void 0,forceEditMode:u,target:t,imageEditorOverride:v,markdownDivCreateNode:m,isValid:S,theme:h})}q={...q,...X};const j=document.getElementById("portal");if(null===j)return console.error('Cannot open Data Grid overlay editor, because portal not found.  Please add `<div id="portal" />` as the last child of your `<body>`.'),null;let z=G?"gdg-style":"gdg-unstyle";S||(z+=" gdg-invalid"),B&&(z+=" gdg-pad");const L=E?.[0]??1,Z=E?.[1]??1;return(0,n.createPortal)(i.createElement(o.Ni.Provider,{value:h},i.createElement(a.Z,{style:(0,o.be)(h),className:f,onClickOutside:T,isOutsideClick:x},i.createElement(d,{ref:W,id:y,className:z,style:q,as:!0===V?"label":void 0,targetX:t.x-L,targetY:t.y-Z,targetWidth:t.width+2*L,targetHeight:t.height+2*Z},i.createElement("div",{className:"gdg-clip-region",onKeyDown:H},Y)))),j)}}}]);